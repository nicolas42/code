<!DOCTYPE html>
<script src="js/draw_mandelbrot.js"></script>

<!-- 
<canvas id="mandelbrot_basic"></canvas>
<script>
function mandelbrot_basic()
{
    var canvas = document.querySelector('#mandelbrot_basic');
    canvas.width = 500; canvas.height = 500;
    var mandelbrot = { x: -0.6999687500000003, y: -0.2901249999999999, zoom: 1024 }
    draw_mandelbrot(canvas, mandelbrot);
}
mandelbrot_basic()
</script>




<canvas id="mandelbrot_interactive" width="500" height="500"></canvas>
<script>

function mandelbrot_interactive()
{
    var canvas = document.querySelector('#mandelbrot_interactive')
    var parameters = { x: -0.6999687500000003, y: -0.2901249999999999, zoom: 1024 };
    draw_mandelbrot(canvas, parameters);


    function redraw_mandelbrot(event) 
    {
        // on left click zoom in
        // on right click zoom out

        if (event.which === 1) {

            // get position of clicked mouse cursor
            var rect = event.currentTarget.getBoundingClientRect();
            var x_pixel = event.clientX - rect.left;
            var y_pixel = event.clientY - rect.top;

            var math_height = 4 / parameters.zoom;
            var math_width = 4 / parameters.zoom;

            parameters.x = (parameters.x - math_width / 2) + x_pixel / (canvas.width / math_width);
            parameters.y = (parameters.y - math_height / 2) + y_pixel / (canvas.height / math_height);
            parameters.zoom *= 2;

        } else if (event.which === 3) {
            parameters.zoom /= 2;
        }

        draw_mandelbrot(canvas, parameters);
    }

    canvas.addEventListener("mousedown", redraw_mandelbrot, false);
    canvas.addEventListener("contextmenu", function(event) { event.preventDefault() });

}

mandelbrot_interactive();

</script>

 -->


<canvas id="mandelbrot_load_url" width="800" height="800"></canvas>
<script>

function mandelbrot_load_url()
{

    function load_url(parameters)
    {
        // get parameters from url
        // taking an argument allows for default parameters to be provided and optionally overriden.

        window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (_, key, value) {
            parameters[key] = parseFloat(value);
        });
        return parameters;
    }

    function show_url(p)
    {
        window.history.replaceState(
            "object or string", "Title", "?x=" + p.x + "&y=" + p.y + "&zoom=" + p.zoom + "&max_iterations=" + p.max_iterations
        );
        // window.history.replaceState(“object or string”, “Title”, “/another-new-url”);
        // from https://computerrock.com/blog/html5-changing-the-browser-url-without-refreshing-page/
    }


    

    var parameters = { x: -0.6999687500000003, y: -0.2901249999999999, zoom: 1024}; // default
    var canvas = document.querySelector('#mandelbrot_load_url')
    parameters = load_url(parameters);
    draw_mandelbrot(canvas, parameters);
    show_url(parameters)

    

    function redraw_mandelbrot(event) 
    {
        // on left click zoom in
        // on right click zoom out

        if (event.which === 1) {

            // get position of clicked mouse cursor
            var rect = event.currentTarget.getBoundingClientRect();
            var x_pixel = event.clientX - rect.left;
            var y_pixel = event.clientY - rect.top;

            var math_height = 4 / parameters.zoom;
            var math_width = 4 / parameters.zoom;

            parameters.x = (parameters.x - math_width / 2) + x_pixel / (canvas.width / math_width);
            parameters.y = (parameters.y - math_height / 2) + y_pixel / (canvas.height / math_height);
            parameters.zoom *= 2;

        } else if (event.which === 3) {
            parameters.zoom /= 2;
        }

        draw_mandelbrot(canvas, parameters);

    }

    canvas.addEventListener("mousedown", function(e){ redraw_mandelbrot(e); show_url(parameters) }, false);
    canvas.addEventListener("contextmenu", function(event) { event.preventDefault() });


}

mandelbrot_load_url();

</script>








<pre>
Append arguments after the url to go to different places
e.g. ...mandelbrot.html?x=-0.6980494359334312&y=-0.29024059804280583&zoom=65536

Interesting Places
------------------------------------------------
?x=-0.6999687500000003&y=-0.2901249999999999&zoom=1024&fullscreen=1
?x=-0.6980494359334312&y=-0.29024059804280583&zoom=65536&max_iterations=1000
?x=-0.027120712995529206&y=0.6441158065199851&zoom=67108864
?x=-0.027099643200635935&y=0.6440290103852749&zoom=268435456
?x=-0.02709963878151032&y=0.6440290090395138&zoom=4294967296
?x=0.31923687500000003&y=-0.4990148437499999&zoom=1024000
?x=0.31923733207893373&y=-0.499014675590515&zoom=8388608000
?x=0.38715883591593053&y=-0.25874134865963394&zoom=1073741824
?x=0.1347109374999998&y=-0.6361328125&zoom=2048
?x=0.2681601562500003&y=-0.004765624999999972&zoom=4096
?x=0.38715883594200756&y=-0.2587413487062&zoom=536870912
?x=0.32898730468750015&y=-0.4237490234374998&zoom=16384
?x=-1.7664619022752155&y=0.041740019425749834&zoom=1073741824&max_iterations=855

If the picture gets too black try upping max_iterations.  Ordinarily max iterations
 is approximated according to the zoom level but it's overrided if you provide it.
</pre>
