<!DOCTYPE html>
<html><head>
<style> * { margin: 0; padding: 0 } </style>
</head>
<body>

    <canvas>click me</canvas>
    <br>
    <audio controls>
        <source src="12monkeys.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
    </audio>

    <pre></pre>
</body>

<script>

function show_turtle(canvas, pattern)
{
    let ctx = canvas.getContext('2d');
    // reset all transforms
    ctx.setTransform();


    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.translate(canvas.width / 2, canvas.height / 2);
    ctx.scale(pattern.scale, pattern.scale);


    ctx.strokeStyle = pattern.color;
    ctx.lineWidth = pattern.line_width;

    for (let stroke_length = 0; stroke_length < pattern.max_distance; stroke_length += 1) {

        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(0, stroke_length);
        ctx.stroke();

        ctx.translate(0, stroke_length);
        ctx.rotate(pattern.angle);
    }
}

function make_random_color()
{
    return "#" + Math.floor(Math.random() * 16777216).toString(16);
}


// ============== Globals ==================
var canvas = document.querySelector('canvas');
canvas.width = window.innerWidth - 20;
canvas.height = window.innerHeight;



var context = canvas.getContext("2d");
context.fillStyle = "black";
context.font = "20px Arial";
context.fillText("click me", (canvas.width / 2) - 17, (canvas.height / 2) + 8);


var interval_id = 0;
function draw_pretties()
{

    var pattern = { 
        angle: Math.random() * 2 * Math.PI,
        color: make_random_color(),
        max_distance: 500,
        scale: 1,
        line_width: 2,
        step: 1
    }
    console.log(pattern);

    clearInterval(interval_id);
    interval_id = setInterval(function(){
        pattern.angle += 0.00001
        // pattern.color = make_random_color();
        show_turtle(canvas, pattern);
    }, 10   ); 

    var pre = document.querySelector('pre');
    pre.innerText += JSON.stringify(pattern) + '\n';
}

var started_music = false;
function draw_pretties_and_start_music()
{
    draw_pretties()

    var audio = document.querySelector('audio')
    if ( audio.paused && !started_music ) { audio.play(); started_music = true; }
}


canvas.addEventListener('click', draw_pretties_and_start_music);

// draw_pretties()

// canvas.onwheel = function(event)
// {
//     event.preventDefault();
//     pattern.angle += event.deltaY / 1000000 * 2 * Math.PI;
//     pattern.color = make_random_color();
//     show_turtle(canvas, pattern);
// }

</script>

</html>